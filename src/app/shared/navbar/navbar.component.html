<nav class="navbar navbar-expand-lg" [ngClass]="{'scrolled': scrolled, 'rtl': isRtl(), 'ltr': !isRtl()}">
  <div class="container-fluid">
    <!-- Logo (Left for LTR, Right for RTL) -->
    <a class="navbar-brand" routerLink="/">
      <img src="../../../assets/images/home/scalewhitelogo.png" alt="Logo" />
    </a>

    <!-- Toggle button for mobile - moved to be direct sibling -->
    <button
      class="navbar-toggler d-lg-none"
      type="button"
      (click)="toggleNavbar()"
      [attr.aria-expanded]="isNavbarExpanded"
      aria-controls="navbarNav"
      [attr.aria-label]="'nav.toggleNavigation' | translate"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Language Toggle and Login/Logout - Desktop only -->
<div class="d-none d-lg-flex flex-column align-items-end gap-2 order-lg-3">
  <!-- Language Toggle Button -->
  <button
    class="btn btn-language-toggle"
    (click)="toggleLanguage()"
    [disabled]="isProfileRoute"
    [title]="currentLanguage === 'ar' ? 'Switch to English' : 'التبديل إلى العربية'"
    type="button">
    <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" class="me-1">
      <path d="M8 1a7 7 0 0 0-7 7 7 7 0 0 0 7 7 7 7 0 0 0 7-7 7 7 0 0 0-7-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"/>
      <path d="M4 8h8"/>
      <path d="M8 4v8"/>
    </svg>
    <span class="d-none d-sm-inline">{{ getLanguageButtonText() }}</span>
  </button>

  <!-- Login/Logout Button -->
  <button class="btn" [ngClass]="isLoggedIn() ? 'btn-danger' : 'btn-primary'" (click)="handleAuthAction()">
    {{ isLoggedIn() ? ('nav.logout' | translate) : ('nav.login' | translate) }}
  </button>
</div>

    <!-- Navbar items (Center) and Buttons (Right) -->
    <div
      class="collapse navbar-collapse"
      [class.show]="isNavbarExpanded"
      id="navbarNav"
    >
      <ul class="navbar-nav mx-auto">
        <li class="nav-item">
          <a class="nav-link" routerLink="/home" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }" (click)="closeNavbar()">
            {{ 'nav.home' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/about" routerLinkActive="active" (click)="closeNavbar()">
            {{ 'nav.about' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/testimonials" routerLinkActive="active" (click)="closeNavbar()">
            {{ 'nav.testimonials' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/library" routerLinkActive="active" (click)="closeNavbar()">
            {{ 'nav.library' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/last-news" routerLinkActive="active" (click)="closeNavbar()">
            {{ 'nav.news' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/join-us" routerLinkActive="active" (click)="closeNavbar()">
            {{ 'nav.joinUs' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/leaderboards" routerLinkActive="active" (click)="closeNavbar()">
            {{ 'nav.leaderboards' | translate }}
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/contact" routerLinkActive="active" (click)="closeNavbar()">
            {{ 'nav.contact' | translate }}
          </a>
        </li>
      </ul>

      <div class="buttons-container d-flex flex-column flex-lg-row align-items-end align-items-lg-center gap-2">
        <!-- Language Toggle and Login/Logout for Mobile - shown in collapsed menu -->
        <div class="d-lg-none mobile-auth-buttons">
          <button
            *ngIf="!isProfileRoute"
            class="btn btn-language-toggle mb-2"
            (click)="toggleLanguage()"
            [title]="currentLanguage === 'ar' ? 'Switch to English' : 'التبديل إلى العربية'"
            type="button">
            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" class="me-1">
              <path d="M8 1a7 7 0 0 0-7 7 7 7 0 0 0 7 7 7 7 0 0 0 7-7 7 7 0 0 0-7-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"/>
              <path d="M4 8h8"/>
              <path d="M8 4v8"/>
            </svg>
            <span>{{ getLanguageButtonText() }}</span>
          </button>

          <button class="btn mb-2" [ngClass]="isLoggedIn() ? 'btn-danger' : 'btn-primary'" (click)="handleAuthAction()">
            {{ isLoggedIn() ? ('nav.logout' | translate) : ('nav.login' | translate) }}
          </button>
        </div>

        <button *ngIf="isAdmin()" class="btn btn-dashboard" (click)="navigateToDashboard()" [title]="'nav.dashboard' | translate">
          <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" [class.me-1]="!isRtl()" [class.ms-1]="isRtl()">
            <rect x="3" y="3" width="7" height="9"></rect>
            <rect x="14" y="3" width="7" height="5"></rect>
            <rect x="14" y="12" width="7" height="9"></rect>
            <rect x="3" y="16" width="7" height="5"></rect>
          </svg>
          <span>{{ 'nav.dashboard' | translate }}</span>
        </button>

        <button *ngIf="isLoggedIn()" class="btn btn-profile" (click)="navigateToProfile()" [title]="'nav.profile' | translate">
          <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" [class.me-1]="!isRtl()" [class.ms-1]="isRtl()">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
          <span>{{ 'nav.profile' | translate }}</span>
        </button>
      </div>
    </div>
  </div>
</nav>
