<div class="container" [attr.dir]="translationService.isRtl() ? 'rtl' : 'ltr'">
  <h2>{{ 'library.title' | translate }}</h2>

  <!-- Search and Filter Section -->
  <div class="search-filter-container">
    <div class="search-bar">
      <button class="clear-btn" (click)="clearSearch()" *ngIf="searchTerm">
        <i class="fas fa-times"></i> {{ 'library.clearSearch' | translate }}
      </button>
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (ngModelChange)="searchPdfs()"
        [placeholder]="'library.searchPlaceholder' | translate"
      >
    </div>

    <div class="filter-options">
      <select [(ngModel)]="filters.subject" (ngModelChange)="filterPdfs()">
        <option value="">{{ 'library.allSubjects' | translate }}</option>
        <option *ngFor="let subject of subjects" [value]="subject">{{ subject }}</option>
      </select>
      <select [(ngModel)]="filters.creatorName" (ngModelChange)="filterPdfs()">
        <option value="">{{ 'library.allCreators' | translate }}</option>
        <option *ngFor="let creator of creators" [value]="creator">{{ creator }}</option>
      </select>
      <select [(ngModel)]="filters.academicLevel" (ngModelChange)="filterPdfs()">
        <option value="">{{ 'library.allAcademicLevels' | translate }}</option>
        <option *ngFor="let level of academicLevels" [value]="level">{{ level }}</option>
      </select>
      <select [(ngModel)]="filters.country" (ngModelChange)="filterPdfs()">
        <option value="">{{ 'library.allCountries' | translate }}</option>
        <option *ngFor="let country of countries" [value]="country">{{ country }}</option>
      </select>
    </div>
  </div>

  <div class="message success" *ngIf="successMessage">{{ successMessage }}</div>
  <div class="message error" *ngIf="errorMessage">{{ errorMessage }}</div>

  <div class="pdf-grid">
    <div *ngFor="let pdf of filteredPdfs; trackBy: trackByPdfId" class="pdf-card" [ngClass]="getAcademicLevelClass(pdf.academicLevel)">
      <!-- Icon section - left side -->
      <div class="pdf-icon-section">
        <i class="fas fa-file-pdf pdf-icon"></i>
      </div>

      <!-- Main content area -->
      <div class="pdf-main-content">
        <div class="pdf-header">
          <h3 class="pdf-title" [attr.title]="pdf.title">{{ pdf.title }}</h3>
          <div class="pdf-description">{{ pdf.description }}</div>
        </div>

        <!-- Special styling for subject, creator, academic level, and country -->
        <div class="special-tags">
          <div class="subject-tag">
            <i class="fas fa-book"></i> {{ pdf.subject }}
          </div>
          <div class="creator-tag">
            <i class="fas fa-user"></i> {{ pdf.creatorName }}
          </div>
          <div class="academicLevel-tag" [ngClass]="getAcademicLevelClass(pdf.academicLevel)">
            <i class="fas fa-graduation-cap"></i> {{ pdf.academicLevel }}
          </div>
          <div class="country-tag">
            <i class="fas fa-globe"></i> {{ pdf.country }}
          </div>
        </div>

        <div class="pdf-details">
          <div class="detail">
            <span class="label">{{ 'library.fileNameLabel' | translate }}</span>
            <span class="file-name"
                  [attr.dir]="isRtl ? 'rtl' : 'ltr'"
                  [attr.title]="isRtl ? pdf.fileName : (pdf['fileNameEn'] || pdf.fileName)">
              {{ isRtl ? pdf.fileName : (pdf['fileNameEn'] || pdf.fileName) }}
            </span>
          </div>
          <div class="detail">
            <span class="label">{{ 'library.createdAtLabel' | translate }}</span>
            <span [attr.dir]="translationService.isRtl() ? 'rtl' : 'ltr'">{{ pdf.createdAt | date:'short':translationService.isRtl() ? 'ar' : 'en' }}</span>
          </div>
        </div>

        <div class="actions">
          <button class="download-btn" (click)="openPdf(pdf.id)">
            <i class="fas fa-file-pdf"></i> {{ 'library.openFile' | translate }}
          </button>
          <button class="share-btn" (click)="sharePdf(pdf.id)">
            <i class="fas fa-share-alt"></i> {{ 'library.share' | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="filteredPdfs.length === 0 && !errorMessage" class="no-results">
    {{ 'library.noPdfs' | translate }}
  </div>
</div>
