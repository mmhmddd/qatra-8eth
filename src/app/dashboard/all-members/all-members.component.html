<div class="page-wrapper" [ngClass]="{'sidebar-hidden': !isSidebarVisible, 'sidebar-visible': isSidebarVisible}">
  <!-- Sidebar Toggle Button for Mobile -->
  <button
    class="sidebar-toggle"
    (click)="toggleSidebar()"
    [class.active]="isSidebarVisible"
    aria-label="Toggle Sidebar">
    <span class="hamburger-line"></span>
    <span class="hamburger-line"></span>
    <span class="hamburger-line"></span>
  </button>

  <!-- Sidebar Overlay for Mobile -->
  <div
    class="sidebar-overlay"
    [class.visible]="isSidebarVisible"
    (click)="toggleSidebar()"></div>

  <app-sidebar [class.visible]="isSidebarVisible"></app-sidebar>

  <main>
    <div class="container">
      <!-- Header Section -->
      <div class="page-header">
        <h2>ุงูุฃุนุถุงุก ุงููุนุชูุฏูู</h2>
        <div class="page-actions">
          <button
            class="refresh-btn"
            (click)="retryFetch()"
            [disabled]="isLoading"
            title="ุชุญุฏูุซ ุงููุงุฆูุฉ">
            <span class="refresh-icon" [class.spinning]="isLoading">๐</span>
            ุชุญุฏูุซ
          </button>
          <button
            class="export-btn"
            (click)="exportToExcel()"
            [disabled]="isLoading || filteredMembers.length === 0"
            title="ุชุตุฏูุฑ ุฅูู Excel">
            <span class="export-icon">๐</span>
            ุชุตุฏูุฑ ุฅูู Excel
          </button>
        </div>
      </div>

      <!-- Success Message -->
      <div *ngIf="successMessage && !isLoading" class="success-message">
        <span class="success-icon">โ</span>
        <span>{{ successMessage }}</span>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoading" class="loading-message">
        <div class="spinner"></div>
        <span>ุฌุงุฑู ุชุญููู ุงูุฃุนุถุงุก...</span>
      </div>

      <!-- Error Message -->
      <div *ngIf="errorMessage && !isLoading" class="error-message">
        <span class="error-icon">โ๏ธ</span>
        <span>{{ errorMessage }}</span>
        <button class="retry-btn" (click)="retryFetch()">ุฅุนุงุฏุฉ ุงููุญุงููุฉ</button>
      </div>

      <!-- Empty State -->
      <div *ngIf="filteredMembers.length === 0 && !errorMessage && !isLoading" class="no-members">
        <span class="no-members-icon">๐ฅ</span>
        <div>
          <h3>ูุง ููุฌุฏ ุฃุนุถุงุก ูุนุชูุฏูู ุญุงูููุง</h3>
          <p>ุณูุธูุฑ ุงูุฃุนุถุงุก ููุง ุจุนุฏ ุงุนุชูุงุฏ ุทูุจุงุช ุงูุงูุถูุงู</p>
        </div>
      </div>

      <!-- Members Table -->
      <div class="table-wrapper" *ngIf="filteredMembers.length > 0 && !isLoading">
        <div class="table-header">
          <input
            type="text"
            class="search-input"
            placeholder="ุงุจุญุซ ุจุงูุงุณู ุฃู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู"
            [(ngModel)]="searchTerm"
            (input)="filterMembers()"
            aria-label="Search members by name or email">
          <h3>ูุงุฆูุฉ ุงูุฃุนุถุงุก ({{ filteredMembers.length }})</h3>
        </div>

        <div class="table-container">
          <table class="members-table">
            <thead>
              <tr>
                <th>ุงูุงุณู</th>
                <th>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</th>
                <th>ุฑูู ุงููุงุชู</th>
                <th>ุงูุชุฎุตุต ุงูุฌุงูุนู</th>
                <th>ุนุฏุฏ ุงูุทูุงุจ</th>
                <th>ุนุฏุฏ ุงูููุงุฏ</th>
                <th>ุณุงุนุงุช ุงูุชุทูุน</th>
                <th>ุนุฏุฏ ุงููุญุงุถุฑุงุช</th>
                <th>ุงูุฅุฌุฑุงุกุงุช</th>
              </tr>
            </thead>
            <tbody>
              <tr
                *ngFor="let member of filteredMembers; trackBy: trackByMemberId"
                [routerLink]="['/member', member.id]"
                class="member-row">
                <td class="member-name">
                  <div class="name-cell">
                    <div class="avatar">{{ member.name ? member.name.charAt(0) : 'ุน' }}</div>
                    <span>{{ member.name || 'ุบูุฑ ูุญุฏุฏ' }}</span>
                  </div>
                </td>
                <td class="member-email">{{ member.email || 'ุบูุฑ ูุญุฏุฏ' }}</td>
                <td class="member-phone">{{ member.phone || 'ุบูุฑ ูุญุฏุฏ' }}</td>
                <td class="member-specialization">{{ member.academicSpecialization || 'ุบูุฑ ูุญุฏุฏ' }}</td>
                <td class="member-students">{{ member.numberOfStudents || 0 }}</td>
                <td class="member-subjects">{{ member.subjectsCount || 0 }}</td>
                <td class="member-hours">
                  <span class="hours-badge">{{ member.volunteerHours || 0 }} ุณุงุนุฉ</span>
                </td>
                <td class="member-lectures">{{ member.lectureCount || 0 }}</td>
                <td class="member-actions">
                  <button
                    class="delete-btn"
                    (click)="confirmDelete(member.id, $event)"
                    title="ุญุฐู ุงูุนุถู">
                    ๐๏ธ ุญุฐู
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Confirmation Dialog -->
      <div *ngIf="showConfirmDialog" class="confirm-dialog">
        <div class="dialog-content">
          <h3>ุชุฃููุฏ ุงูุญุฐู</h3>
          <p>ูู ุฃูุช ูุชุฃูุฏ ุฃูู ุชุฑูุฏ ุญุฐู ูุฐุง ุงูุนุถูุ ูุฐุง ุงูุฅุฌุฑุงุก ูุง ูููู ุงูุชุฑุงุฌุน ุนูู.</p>
          <div class="dialog-actions">
            <button class="confirm-btn" (click)="deleteMember()">ุชุฃููุฏ</button>
            <button class="cancel-btn" (click)="cancelDelete()">ุฅูุบุงุก</button>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
