<div class="dashboard-wrapper">
  <app-sidebar class="sidebar"></app-sidebar>

  <main class="main-content">
    <header class="dashboard-header">
      <h1>لوحة التحكم</h1>
      <div class="notification-area">
        <div class="notification-icon" (click)="toggleNotifications()">
          <i class="fas fa-bell"></i>
          <span *ngIf="unreadNotificationsCount > 0" class="badge">{{ unreadNotificationsCount }}</span>
        </div>
        <div *ngIf="showNotifications" class="notifications-dropdown" [ngClass]="{'show': showNotifications}">
          <div class="notifications-header">
            الإشعارات
            <span class="close-btn" (click)="closeNotifications()">&times;</span>
          </div>
          <div *ngIf="!notifications?.length" class="no-notifications">لا توجد إشعارات جديدة</div>
          <div *ngFor="let notification of notifications" class="notification-item" [ngClass]="{'unread': !notification.read}">
            <p>{{ notification.message }}</p>
            <small>{{ notification.createdAt | date:'short' }}</small>
          </div>
        </div>
      </div>
    </header>

    <div class="counters-container">
      <div class="counters">
        <span class="counter">
          <i class="fas fa-users me-2"></i>
          عدد الأعضاء: {{ membersCount }}
        </span>
        <span class="counter">
          <i class="fas fa-file-alt me-2"></i>
          عدد الطلبات: {{ joinRequestsCount }}
        </span>
        <button class="btn btn-primary" (click)="exportToExcel()">تصدير الأعضاء إلى Excel</button>
        <button class="btn btn-primary" (click)="exportStudentsToExcel()">تصدير تفاصيل الطلاب إلى Excel</button>
      </div>
    </div>

    <section class="content-area">
      <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
        {{ error }}
        <button type="button" class="btn-close" (click)="error = null"></button>
      </div>

      <div class="dashboard-section">
        <h2 class="section-header">إدارة الأعضاء والطلبات</h2>
        <div class="dashboard-grid">
          <div class="dashboard-tile tile-members" (click)="navigateTo('/all-members')">
            <i class="fas fa-users"></i>
            <h3 class="tile-title">عرض جميع الأعضاء</h3>
            <p class="tile-text">عرض قائمة الأعضاء المعتمدين</p>
          </div>
          <div class="dashboard-tile tile-requests" (click)="navigateTo('/all-join-request')">
            <i class="fas fa-file-alt"></i>
            <h3 class="tile-title">عرض جميع الطلبات</h3>
            <p class="tile-text">عرض طلبات الانضمام</p>
          </div>
          <div class="dashboard-tile tile-low-lecture" (click)="navigateTo('/low-lecture-members')">
            <i class="fas fa-user-times"></i>
            <h3 class="tile-title">الأعضاء المقصرون</h3>
            <p class="tile-text">عرض قائمة الأعضاء المقصرين</p>
          </div>
        </div>
      </div>

      <div class="dashboard-section">
        <h2 class="section-header">إدارة المحتوى</h2>
        <div class="dashboard-grid">
          <div class="dashboard-tile tile-book" (click)="navigateTo('/upload-pdf')">
            <i class="fas fa-book"></i>
            <h3 class="tile-title">إضافة كتاب</h3>
            <p class="tile-text">إضافة كتاب جديد إلى النظام</p>
          </div>
          <div class="dashboard-tile tile-opinion" (click)="navigateTo('/add-testimonials')">
            <i class="fas fa-comment-dots"></i>
            <h3 class="tile-title">إضافة رأي</h3>
            <p class="tile-text">إضافة رأي عميل</p>
          </div>
          <div class="dashboard-tile tile-gallery" (click)="navigateTo('/add-gallery')">
            <i class="fas fa-image"></i>
            <h3 class="tile-title">إضافة صورة</h3>
            <p class="tile-text">إضافة صورة في معرض الصور</p>
          </div>

            <div class="dashboard-tile tile-join-message" (click)="navigateTo('/join-massege')">
            <i class="fas fa-file-alt"></i>
            <h3 class="tile-title">رسالة صفحة الانضمام</h3>
            <p class="tile-text">عرض رسالة صفحة الانضمام</p>
          </div>
        </div>
      </div>

      <div class="dashboard-section">
        <h2 class="section-header">إدارة المحاضرات والمتصدرين</h2>
        <div class="dashboard-grid">
          <div class="dashboard-tile tile-leaderboard" (click)="navigateTo('/add-leaderboards')">
            <i class="fas fa-trophy"></i>
            <h3 class="tile-title">إضافة متصدر</h3>
            <p class="tile-text">إضافة متصدر جديد</p>
          </div>
          <div class="dashboard-tile tile-request-pdf" (click)="navigateTo('/lectures-request')">
            <i class="fas fa-file-alt"></i>
            <h3 class="tile-title">طلبات PDF المحاضرات</h3>
            <p class="tile-text">عرض قائمة طلبات رفع المحاضرات</p>
          </div>
          <div class="dashboard-tile tile-request-drive" (click)="navigateTo('/drive-lecture')">
            <i class="fas fa-file-alt"></i>
            <h3 class="tile-title">طلبات محاضرات الـ Drive</h3>
            <p class="tile-text">عرض قائمة طلبات رفع المحاضرات</p>
          </div>

        </div>
      </div>

      <router-outlet></router-outlet>
    </section>
  </main>
</div>
